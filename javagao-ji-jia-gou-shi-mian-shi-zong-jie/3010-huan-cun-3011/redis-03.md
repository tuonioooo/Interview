# Redis—03

**1.twemproxy概念及原理**

大概概念，它雷士与一个代理方式，使用方法和普通的redis无任何区别，设置好它的下属多个redis实例后，使用时在本地需要链接redis的地方改为twemproxy,它会以代理的身份接受请求并使用一致性hash算法，将请求转接到具体redis，将结果在返回twemproxy.使用方式简便（相对redis只需修改连接端口），对旧项目扩展的首选。

问题：twemproxy自身端口实例的压力，使用一致性hash后，对于redis结点数量改变时候的计算值的改变，数据无法自动移动到新的结点。

#### **2.Redis都有哪些集群方案？**

* twemproxy
* codis
* edis cluster3.0自带的集群
* 在业务层代码实现

#### 3.如何在业务代码层实现集群？

起几个毫无关系的redis实例，在代码层，对Key进行hash计算，然后去对应的redis实例操作数据。这种方式对hash层代码要求比较高，考虑部分包括，节点失效后的替代算法方案，数据震荡后的自动脚本恢复，实例的监控等等。

#### 4.分布式Redis是前期做还是后期规模上来了做再好？为什么？

既然Redis是如此轻量（单实例只使用1M内存），为防止以后扩容，最好的办法就是一开始就启动较多实例。即便你有一台服务器，你也可以一开始就让Redis以分布式的方式运行，使用分区，在同一台服务器上启动多个实例。

一开始就多设置几个Redis实例，例如32或者64个实例，对大多数用户来说这操作起来可能比较玛法，但是从长久来看这点牺牲是值得的。

这样的话，当你的数据不断增长，需要更多的Redis服务器时，你需要做的就是仅仅将Redis实例从一台服务器迁移到另外一台服务器而已（而不需要重新考虑分区的问题）。一旦你添加了另一台服务器，你需要将你一般的Redis实例从第一台机器迁到第二台机器。

#### 5.一个Redis实例最多能存放多少的keys?

理论上Redis可以处理多大232的keys，并且在实际中进行了测试，每个实例至少存放了2亿5千万的keys。

#### 6.一个字符串类型的值能存储最大容量是多少？

512M

#### 7.Redis如何做大量数据插入？

Redis2.6开始redis-cli支持一种新的被称之为pipemode的新模式用于执行大量数据插入工作。

#### 8.Redis的内存用完了会发生什么？

如果达到设置的上线，Redis的写命令会返回错误信息（但是读命令还可以正常返回。）或者你可以将Redis当缓存来使用配置淘汰机制，当Redis达到内存上限时会冲刷掉旧的内容。

